<!DOCTYPE html>
<html lang="en">
<head>
        <title>Seyrusefer</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="bootstrap-icons.css">
        <script src="jquery.min.js"></script>
        <script src="popper.min.js" crossorigin="anonymous"></script>
        <script src="bootstrap.min.js" crossorigin="anonymous"></script>
        <script>
                String.prototype.format = function() {
                        let a = this;
                        for (let k in arguments) {
                                a = a.replace("{" + k + "}", arguments[k])
                        }
                        return a
                }

                function init () {
                        let wwwUrl                      = `http://${window.location.hostname}:${window.location.port}`;
                        let apiUrl                      = `http://${window.location.hostname}:${window.location.port}/api`;
                        let apiSettingsGet              = "/settings/get";
                        let apiSettingsSet              = "/settings/set";
                        let apiSystemRestart            = "/system/restart";
                        let apiSystemRestore            = "/system/restore";
                        let apiTimeout                  = 10 * 1000;

                        let elementSeyrusefersLink      = document.getElementById("elementSeyrusefersLink");
                        let elementSeyruseferLink       = document.getElementById("elementSeyruseferLink");
                        let elementCommandSeperator     = document.getElementById("elementCommandSeperator");
                        let elementCommandName          = document.getElementById("elementCommandName");
                        let elementSeyruseferId         = document.getElementById("elementSeyruseferId");

                        let elementSeyruseferDiv        = document.getElementById("elementSeyruseferDiv");

                        let elementSettingsDiv          = document.getElementById("elementSettingsDiv");
                        let elementSettingsLink         = document.getElementById("elementSettingsLink");
                        let elementSettingsResultDiv    = document.getElementById("elementSettingsResultDiv");

                        let elementFirmwareDiv          = document.getElementById("elementFirmwareDiv");
                        let elementFirmwareLink         = document.getElementById("elementFirmwareLink");
                        let elementFirmwareResultDiv    = document.getElementById("elementFirmwareResultDiv");

                        let elementRestoreDiv           = document.getElementById("elementRestoreDiv");
                        let elementRestoreLink          = document.getElementById("elementRestoreLink");
                        let elementRestoreResultDiv     = document.getElementById("elementRestoreResultDiv");

                        let elementRestartDiv           = document.getElementById("elementRestartDiv");
                        let elementRestartLink          = document.getElementById("elementRestartLink");
                        let elementRestartResultDiv     = document.getElementById("elementRestartResultDiv");

                        let elementAboutDiv             = document.getElementById("elementAboutDiv");
                        let elementAboutLink            = document.getElementById("elementAboutLink");
                        let elementAboutResultDiv       = document.getElementById("elementAboutResultDiv");

                        elementsReset = function () {
                                elementSeyruseferDiv.style.display      = "none";
                                elementCommandSeperator.innerHTML       = "";
                                elementCommandName.innerHTML            = "";

                                elementSettingsDiv.style.display        = "none";
                                elementSettingsResultDiv.innerHTML      = "";

                                elementFirmwareDiv.style.display        = "none";
                                elementFirmwareResultDiv.innerHTML      = "";

                                elementRestoreDiv.style.display         = "none";
                                elementRestoreResultDiv.innerHTML       = "";

                                elementRestartDiv.style.display         = "none";
                                elementRestartResultDiv.innerHTML       = "";

                                elementAboutDiv.style.display           = "none";
                                elementAboutResultDiv.innerHTML         = "";
                        }

                        elementSeyruseferLink.onclick = function () {
                                elementsReset();
                                elementSeyruseferDiv.style.display      = "block";
                                elementCommandSeperator.innerHTML       = "";
                                elementCommandName.innerHTML            = "";
                        }

                        elementSettingsLink.onclick = function () {
                                elementsReset();
                                elementSettingsDiv.style.display        = "block";
                                elementCommandSeperator.innerHTML       = "/";
                                elementCommandName.innerHTML            = "Settings";
                                elementSettingsUpdate(0);
                        }

                        elementFirmwareLink.onclick = function () {
                                elementsReset();
                                elementFirmwareDiv.style.display        = "block";
                                elementCommandSeperator.innerHTML       = "/";
                                elementCommandName.innerHTML            = "Firmware";
                                elementFirmwareUpdate();
                        }

                        elementRestoreLink.onclick = function () {
                                elementsReset();
                                elementRestoreDiv.style.display        = "block";
                                elementCommandSeperator.innerHTML       = "/";
                                elementCommandName.innerHTML            = "Restore";
                                elementRestoreUpdate();
                        }

                        elementRestartLink.onclick = function () {
                                elementsReset();
                                elementRestartDiv.style.display        = "block";
                                elementCommandSeperator.innerHTML       = "/";
                                elementCommandName.innerHTML            = "Restart";
                                elementRestartUpdate();
                        }

                        elementAboutLink.onclick = function () {
                                elementsReset();
                                elementAboutDiv.style.display        = "block";
                                elementCommandSeperator.innerHTML       = "/";
                                elementCommandName.innerHTML            = "About";
                                elementAboutUpdate();
                        }

                        elementSettingsChanged = function () {
                                let m;
                                let b;
                                let settings;

                                let elementScrollTop    = document.documentElement.scrollTop;
                                let elementSettingsMode = document.getElementById("elementSettingsMODE");

                                settings = {};
                                settings.mode = elementSettingsMode.value;
                                settings.led = {};
                                settings.led.brightness = document.getElementById(`elementSettingsLED:BRIGHTNESS`).value;
                                settings.modes = [];

                                for (m = 1; m <= 5; m++) {
                                        let settingsMode;
                                        settingsMode = {};
                                        settingsMode.buttons = [];
                                        for (b = 1; b <= 5; b++) {
                                                let settingsButton;
                                                let elementSettingsButton = document.getElementById(`elementSettingsMODE_${m}:BUTTON_${b}`);
                                                settingsButton = {};
                                                settingsButton.key = elementSettingsButton.value;
                                                settingsMode.buttons.push(settingsButton);
                                        }
                                        settings.modes.push(settingsMode);
                                }

                                console.log("settings: {0}".format(JSON.stringify(settings)));

                                const controller = new AbortController();
                                const timeoutId = setTimeout(() => controller.abort(), apiTimeout);
                                fetch(`${apiUrl}${apiSettingsSet}`, {
                                        method: 'POST',
                                        signal: controller.signal,
                                        credentials: 'omit',
                                        headers: {
                                                'Accept': 'application/json',
                                                'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify(settings)
                                }).then(res => {
                                        if (res.ok == true && res.status === 200) {
                                                return res.json();
                                        } else {
                                                console.log("api call: {0}{1} failed, res: {2}, {3}".format(apiUrl, apiSettingsSet, res.ok, res.status))
                                                throw new Error();
                                        }
                                }) .then(json => {
                                        elementSettingsUpdate(elementScrollTop);
                                }) .catch(e => {
                                        console.error(e);

                                        elementSettingsResultDiv.innerHTML = "Can not set settings, try again later.";
                                });
                        }

                        elementSettingsUpdate = function (scrollTop) {
                                const controller = new AbortController();
                                const timeoutId = setTimeout(() => controller.abort(), apiTimeout);
                                fetch(`${apiUrl}${apiSettingsGet}`, {
                                        method: 'GET',
                                        signal: controller.signal,
                                        credentials: 'omit',
                                        headers: {
                                                'Accept': 'application/json'
                                        }
                                }).then(res => {
                                        if (res.ok == true && res.status === 200) {
                                                return res.json();
                                        } else {
                                                console.log("api call: {0}{1} failed, res: {2}, {3}".format(apiUrl, apiSettingsGet, res.ok, res.status))
                                                throw new Error();
                                        }
                                }) .then(json => {
                                        let i;
                                        let h;

                                        console.log("{0}{1}".format(apiUrl, apiSettingsGet));
                                        console.log("  mode                    : {0}".format(json.mode));
                                        console.log("  led.brightness          : {0}".format(json.led.brightness));
                                        console.log("  modes[0].buttons[0].key : {0}".format(json.modes[0].buttons[0].key));
                                        console.log("  modes[0].buttons[1].key : {0}".format(json.modes[0].buttons[1].key));
                                        console.log("  modes[0].buttons[2].key : {0}".format(json.modes[0].buttons[2].key));
                                        console.log("  modes[0].buttons[3].key : {0}".format(json.modes[0].buttons[3].key));
                                        console.log("  modes[0].buttons[4].key : {0}".format(json.modes[0].buttons[4].key));
                                        console.log("  modes[1].buttons[0].key : {0}".format(json.modes[1].buttons[0].key));
                                        console.log("  modes[1].buttons[1].key : {0}".format(json.modes[1].buttons[1].key));
                                        console.log("  modes[1].buttons[2].key : {0}".format(json.modes[1].buttons[2].key));
                                        console.log("  modes[1].buttons[3].key : {0}".format(json.modes[1].buttons[3].key));
                                        console.log("  modes[1].buttons[4].key : {0}".format(json.modes[1].buttons[4].key));
                                        console.log("  modes[2].buttons[0].key : {0}".format(json.modes[2].buttons[0].key));
                                        console.log("  modes[2].buttons[1].key : {0}".format(json.modes[2].buttons[1].key));
                                        console.log("  modes[2].buttons[2].key : {0}".format(json.modes[2].buttons[2].key));
                                        console.log("  modes[2].buttons[3].key : {0}".format(json.modes[2].buttons[3].key));
                                        console.log("  modes[2].buttons[4].key : {0}".format(json.modes[2].buttons[4].key));
                                        console.log("  modes[3].buttons[0].key : {0}".format(json.modes[3].buttons[0].key));
                                        console.log("  modes[3].buttons[1].key : {0}".format(json.modes[3].buttons[1].key));
                                        console.log("  modes[3].buttons[2].key : {0}".format(json.modes[3].buttons[2].key));
                                        console.log("  modes[3].buttons[3].key : {0}".format(json.modes[3].buttons[3].key));
                                        console.log("  modes[3].buttons[4].key : {0}".format(json.modes[3].buttons[4].key));
                                        console.log("  modes[4].buttons[0].key : {0}".format(json.modes[4].buttons[0].key));
                                        console.log("  modes[4].buttons[1].key : {0}".format(json.modes[4].buttons[1].key));
                                        console.log("  modes[4].buttons[2].key : {0}".format(json.modes[4].buttons[2].key));
                                        console.log("  modes[4].buttons[3].key : {0}".format(json.modes[4].buttons[3].key));
                                        console.log("  modes[4].buttons[4].key : {0}".format(json.modes[4].buttons[4].key));

                                        let parameters = [
                                                { "id": "MODE", "name": "MODE", "value": json.mode, "type": "mode" },
                                                { "id": "LED", "name": "LED", "value": null, "type": "title" },
                                                { "id": "LED:BRIGHTNESS", "name": "BRIGHTNESS", "value": json.led.brightness, "type": "brightness" },
                                                { "id": "MODE_1", "name": "MODE_1", "value": null, "type": "title" },
                                                { "id": "MODE_1:BUTTON_1", "name": "BUTTON_1", "value": json.modes[0].buttons[0].key, "type": "key" },
                                                { "id": "MODE_1:BUTTON_2", "name": "BUTTON_2", "value": json.modes[0].buttons[1].key, "type": "key" },
                                                { "id": "MODE_1:BUTTON_3", "name": "BUTTON_3", "value": json.modes[0].buttons[2].key, "type": "key" },
                                                { "id": "MODE_1:BUTTON_4", "name": "BUTTON_4", "value": json.modes[0].buttons[3].key, "type": "key" },
                                                { "id": "MODE_1:BUTTON_5", "name": "BUTTON_5", "value": json.modes[0].buttons[4].key, "type": "key" },
                                                { "id": "MODE_2", "name": "MODE_2", "value": null, "type": "title" },
                                                { "id": "MODE_2:BUTTON_1", "name": "BUTTON_1", "value": json.modes[1].buttons[0].key, "type": "key" },
                                                { "id": "MODE_2:BUTTON_2", "name": "BUTTON_2", "value": json.modes[1].buttons[1].key, "type": "key" },
                                                { "id": "MODE_2:BUTTON_3", "name": "BUTTON_3", "value": json.modes[1].buttons[2].key, "type": "key" },
                                                { "id": "MODE_2:BUTTON_4", "name": "BUTTON_4", "value": json.modes[1].buttons[3].key, "type": "key" },
                                                { "id": "MODE_2:BUTTON_5", "name": "BUTTON_5", "value": json.modes[1].buttons[4].key, "type": "key" },
                                                { "id": "MODE_3", "name": "MODE_3", "value": null, "type": "title" },
                                                { "id": "MODE_3:BUTTON_1", "name": "BUTTON_1", "value": json.modes[2].buttons[0].key, "type": "key" },
                                                { "id": "MODE_3:BUTTON_2", "name": "BUTTON_2", "value": json.modes[2].buttons[1].key, "type": "key" },
                                                { "id": "MODE_3:BUTTON_3", "name": "BUTTON_3", "value": json.modes[2].buttons[2].key, "type": "key" },
                                                { "id": "MODE_3:BUTTON_4", "name": "BUTTON_4", "value": json.modes[2].buttons[3].key, "type": "key" },
                                                { "id": "MODE_3:BUTTON_5", "name": "BUTTON_5", "value": json.modes[2].buttons[4].key, "type": "key" },
                                                { "id": "MODE_4", "name": "MODE_4", "value": null, "type": "title" },
                                                { "id": "MODE_4:BUTTON_1", "name": "BUTTON_1", "value": json.modes[3].buttons[0].key, "type": "key" },
                                                { "id": "MODE_4:BUTTON_2", "name": "BUTTON_2", "value": json.modes[3].buttons[1].key, "type": "key" },
                                                { "id": "MODE_4:BUTTON_3", "name": "BUTTON_3", "value": json.modes[3].buttons[2].key, "type": "key" },
                                                { "id": "MODE_4:BUTTON_4", "name": "BUTTON_4", "value": json.modes[3].buttons[3].key, "type": "key" },
                                                { "id": "MODE_4:BUTTON_5", "name": "BUTTON_5", "value": json.modes[3].buttons[4].key, "type": "key" },
                                                { "id": "MODE_5", "name": "MODE_5", "value": null, "type": "title" },
                                                { "id": "MODE_5:BUTTON_1", "name": "BUTTON_1", "value": json.modes[4].buttons[0].key, "type": "key" },
                                                { "id": "MODE_5:BUTTON_2", "name": "BUTTON_2", "value": json.modes[4].buttons[1].key, "type": "key" },
                                                { "id": "MODE_5:BUTTON_3", "name": "BUTTON_3", "value": json.modes[4].buttons[2].key, "type": "key" },
                                                { "id": "MODE_5:BUTTON_4", "name": "BUTTON_4", "value": json.modes[4].buttons[3].key, "type": "key" },
                                                { "id": "MODE_5:BUTTON_5", "name": "BUTTON_5", "value": json.modes[4].buttons[4].key, "type": "key" },
                                        ];

                                        h  = ``;
                                        h += `<table class="table">`;

                                        for (i = 0; i < parameters.length; i++) {
                                                let d = parameters[i].id != null ? parameters[i].id : "";
                                                let n = parameters[i].name != null ? parameters[i].name : "";
                                                let v = parameters[i].value != null ? parameters[i].value : "";
                                                let t = parameters[i].type != null ? parameters[i].type : "";
                                                h += `<tr>`;
                                                h += `<td></td>`;
                                                if (t == "key") {
                                                        h += `<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${n}</td>`;
                                                } else if (t == "brightness") {
                                                        h += `<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${n}</td>`;
                                                } else {
                                                        h += `<td>${n}</td>`;
                                                }
                                                if (t == "brightness") {
                                                        let values = [
                                                                "20",
                                                                "35",
                                                                "50",
                                                                "65",
                                                                "80",
                                                                "100"
                                                        ];
                                                        h += `<td>`;
                                                        h += `<select id="elementSettings${d}" onchange="elementSettingsChanged()" class="form-select" aria-label="Default select example">`;
                                                        for (j = 0; j < values.length; j++) {
                                                                if (values[j] == v) {
                                                                        h += `<option value="${values[j]}" selected>${values[j]}</option>`;
                                                                } else {
                                                                        h += `<option value="${values[j]}">${values[j]}</option>`;
                                                                }
                                                        }
                                                        h += `</select>`;
                                                        h += `</td>`;
                                                } else if (t == "mode") {
                                                        let modes = [
                                                                "MODE_1",
                                                                "MODE_2",
                                                                "MODE_3",
                                                                "MODE_4",
                                                                "MODE_5"
                                                        ];
                                                        h += `<td>`;
                                                        h += `<select id="elementSettings${d}" onchange="elementSettingsChanged()" class="form-select" aria-label="Default select example">`;
                                                        for (j = 0; j < modes.length; j++) {
                                                                if (modes[j] == v) {
                                                                        h += `<option value="${modes[j]}" selected>${modes[j]}</option>`;
                                                                } else {
                                                                        h += `<option value="${modes[j]}">${modes[j]}</option>`;
                                                                }
                                                        }
                                                        h += `</select>`;
                                                        h += `</td>`;
                                                } else if (t == "key") {
                                                        let keys = [
                                                                "KEY_RESERVED",
                                                                "KEY_A",
                                                                "KEY_B",
                                                                "KEY_C",
                                                                "KEY_D",
                                                                "KEY_E",
                                                                "KEY_F",
                                                                "KEY_G",
                                                                "KEY_H",
                                                                "KEY_I",
                                                                "KEY_J",
                                                                "KEY_K",
                                                                "KEY_L",
                                                                "KEY_M",
                                                                "KEY_N",
                                                                "KEY_O",
                                                                "KEY_P",
                                                                "KEY_Q",
                                                                "KEY_R",
                                                                "KEY_S",
                                                                "KEY_T",
                                                                "KEY_U",
                                                                "KEY_V",
                                                                "KEY_W",
                                                                "KEY_X",
                                                                "KEY_Y",
                                                                "KEY_Z",
                                                                "KEY_1",
                                                                "KEY_2",
                                                                "KEY_3",
                                                                "KEY_4",
                                                                "KEY_5",
                                                                "KEY_6",
                                                                "KEY_7",
                                                                "KEY_8",
                                                                "KEY_9",
                                                                "KEY_0",
                                                                "KEY_RETURN",
                                                                "KEY_ESCAPE",
                                                                "KEY_DELETE",
                                                                "KEY_TAB",
                                                                "KEY_SPACEBAR",
                                                                "KEY_MINUS",
                                                                "KEY_EQUAL",
                                                                "KEY_LEFT_BRKT",
                                                                "KEY_RIGHT_BRKT",
                                                                "KEY_BACK_SLASH",
                                                                "KEY_SEMI_COLON",
                                                                "KEY_SGL_QUOTE",
                                                                "KEY_GRV_ACCENT",
                                                                "KEY_COMMA",
                                                                "KEY_DOT",
                                                                "KEY_FWD_SLASH",
                                                                "KEY_CAPS_LOCK",
                                                                "KEY_F1",
                                                                "KEY_F2",
                                                                "KEY_F3",
                                                                "KEY_F4",
                                                                "KEY_F5",
                                                                "KEY_F6",
                                                                "KEY_F7",
                                                                "KEY_F8",
                                                                "KEY_F9",
                                                                "KEY_F10",
                                                                "KEY_F11",
                                                                "KEY_F12",
                                                                "KEY_PRNT_SCREEN",
                                                                "KEY_SCROLL_LOCK",
                                                                "KEY_PAUSE",
                                                                "KEY_INSERT",
                                                                "KEY_HOME",
                                                                "KEY_PAGE_UP",
                                                                "KEY_DELETE_FWD",
                                                                "KEY_END",
                                                                "KEY_PAGE_DOWN",
                                                                "KEY_RIGHT_ARROW",
                                                                "KEY_LEFT_ARROW",
                                                                "KEY_DOWN_ARROW",
                                                                "KEY_UP_ARROW",
                                                                "KEY_NUM_LOCK",
                                                                "KEY_DIVIDE",
                                                                "KEY_MULTIPLY",
                                                                "KEY_SUBTRACT",
                                                                "KEY_ADD",
                                                                "KEY_ENTER",
                                                                "KEYPAD_1",
                                                                "KEYPAD_2",
                                                                "KEYPAD_3",
                                                                "KEYPAD_4",
                                                                "KEYPAD_5",
                                                                "KEYPAD_6",
                                                                "KEYPAD_7",
                                                                "KEYPAD_8",
                                                                "KEYPAD_9",
                                                                "KEYPAD_0",
                                                                "KEYPAD_DOT",
                                                                "KEY_MUTE",
                                                                "KEY_VOLUME_UP",
                                                                "KEY_VOLUME_DOWN",
                                                                "KEY_LEFT_CTRL",
                                                                "KEY_LEFT_SHIFT",
                                                                "KEY_LEFT_ALT",
                                                                "KEY_LEFT_GUI",
                                                                "KEY_RIGHT_CTRL",
                                                                "KEY_RIGHT_SHIFT",
                                                                "KEY_RIGHT_ALT",
                                                                "KEY_RIGHT_GUI",

                                                                "MOUSE_LEFT",
                                                                "MOUSE_MIDDLE",
                                                                "MOUSE_RIGHT",

                                                                "CONSUMER_POWER",
                                                                "CONSUMER_RESET",
                                                                "CONSUMER_SLEEP",

                                                                "CONSUMER_MENU",
                                                                "CONSUMER_SELECTION",
                                                                "CONSUMER_ASSIGN_SEL",
                                                                "CONSUMER_MODE_STEP",
                                                                "CONSUMER_RECALL_LAST",
                                                                "CONSUMER_QUIT",
                                                                "CONSUMER_HELP",
                                                                "CONSUMER_CHANNEL_UP",
                                                                "CONSUMER_CHANNEL_DOWN",

                                                                "CONSUMER_PLAY",
                                                                "CONSUMER_PAUSE",
                                                                "CONSUMER_RECORD",
                                                                "CONSUMER_FAST_FORWARD",
                                                                "CONSUMER_REWIND",
                                                                "CONSUMER_SCAN_NEXT_TRK",
                                                                "CONSUMER_SCAN_PREV_TRK",
                                                                "CONSUMER_STOP",
                                                                "CONSUMER_EJECT",
                                                                "CONSUMER_RANDOM_PLAY",
                                                                "CONSUMER_SELECT_DISC",
                                                                "CONSUMER_ENTER_DISC",
                                                                "CONSUMER_REPEAT",
                                                                "CONSUMER_STOP_EJECT",
                                                                "CONSUMER_PLAY_PAUSE",
                                                                "CONSUMER_PLAY_SKIP",

                                                                "CONSUMER_VOLUME",
                                                                "CONSUMER_BALANCE",
                                                                "CONSUMER_MUTE",
                                                                "CONSUMER_BASS",
                                                                "CONSUMER_VOLUME_UP",
                                                                "CONSUMER_VOLUME_DOWN",
                                                        ];
                                                        h += `<td>`;
                                                        h += `<select id="elementSettings${d}" onchange="elementSettingsChanged()" class="form-select" aria-label="Default select example">`;
                                                        for (j = 0; j < keys.length; j++) {
                                                                if (keys[j] == v) {
                                                                        h += `<option value="${keys[j]}" selected>${keys[j]}</option>`;
                                                                } else {
                                                                        h += `<option value="${keys[j]}">${keys[j]}</option>`;
                                                                }
                                                        }
                                                        h += `</select>`;
                                                        h += `</td>`;
                                                } else if (t == "string") {
                                                        h += `<td><input id="elementSettings${d}" onchange="elementSettingsChanged()" type="text" class="form-control" value="${v}""></td>`;
                                                } else if (t == "integer") {
                                                        h += `<td><input id="elementSettings${d}" onchange="elementSettingsChanged()" type="text" oninput="this.value=this.value.replace(/[^0-9]/g,'');" class="form-control" value="${v}""></td>`;
                                                } else if (t == "title") {
                                                        h += `<td></td>`;
                                                } else {
                                                        h += `<td>${v}</td>`;
                                                }
                                                h += `</tr>`;
                                        }

                                        h += `</table>`;

                                        elementSettingsResultDiv.innerHTML = h;
                                        document.documentElement.scrollTop = scrollTop;
                                }) .catch(e => {
                                        console.error(e);
                                        elementSettingsResultDiv.innerHTML = "Can not get settings, try again later.";
                                });
                        }

                        elementFirmwareUpdate = function () {
                        }

                        elementRestoreUpdate = function () {
                                elementRestoreResultDiv.innerHTML = "Sending restore command...";

                                const controller = new AbortController();
                                const timeoutId = setTimeout(() => controller.abort(), apiTimeout);
                                fetch(`${apiUrl}${apiSystemRestore}`, {
                                        method: 'GET',
                                        signal: controller.signal,
                                        credentials: 'omit',
                                        headers: {
                                                'Accept': 'application/json'
                                        }
                                }).then(res => {
                                        if (res.ok == true && res.status === 200) {
                                                return res.json();
                                        } else {
                                                console.log("api call: {0}{1} failed, res: {2}, {3}".format(apiUrl, apiSystemRestore, res.ok, res.status))
                                                throw new Error();
                                        }
                                }) .then(json => {
                                        elementRestoreResultDiv.innerHTML = "Successfully sent restore command. Device will restart in 2 seconds, Wifi connection will be lost.";
                                }) .catch(e => {
                                        console.error(e);
                                        elementRestoreResultDiv.innerHTML = "Can not send restore command, try again later.";
                                });
                        }

                        elementRestartUpdate = function () {
                                elementRestartResultDiv.innerHTML = "Sending restart command...";

                                const controller = new AbortController();
                                const timeoutId = setTimeout(() => controller.abort(), apiTimeout);
                                fetch(`${apiUrl}${apiSystemRestart}`, {
                                        method: 'GET',
                                        signal: controller.signal,
                                        credentials: 'omit',
                                        headers: {
                                                'Accept': 'application/json'
                                        }
                                }).then(res => {
                                        if (res.ok == true && res.status === 200) {
                                                return res.json();
                                        } else {
                                                console.log("api call: {0}{1} failed, res: {2}, {3}".format(apiUrl, apiSystemRestart, res.ok, res.status))
                                                throw new Error();
                                        }
                                }) .then(json => {
                                        elementRestartResultDiv.innerHTML = "Successfully sent restart command. Device will restart in 2 seconds, Wifi connection will be lost.";
                                }) .catch(e => {
                                        console.error(e);
                                        elementRestartResultDiv.innerHTML = "Can not send restart command, try again later.";
                                });
                        }

                        elementAboutUpdate = function () {
                                let h;
                                h  = "<p>Controlling unit designed for adventure bikes.</p>"
                                h += "<p>Controlling unit is a Bluetooth remote device that lets you to " +
                                     "operate various applications from handlebar without any need to " +
                                     "touch the display.</p>";
                                elementAboutResultDiv.innerHTML = h;
                        }

                        elementsReset();
                        elementSeyruseferDiv.style.display = "block";

                        elementSeyruseferId.innerHTML = "v1.0.2";
                }
        </script>
</head>
<body onload="init()">
        <div class="container">
                <nav class="navbar navbar-expand-sm bg-light navbar-light">
                        <div class="container-fluid">
                                <a id="elementSeyruseferLink" class="navbar-brand" href="#"><h4 class="mb-1">Seyrusefer</h4></a>
                                <a id="elementCommandSeperator" class="navbar-brand"></a>
                                <a id="elementCommandName" class="navbar-brand"></a>
                                <div class="collapse navbar-collapse" id="mynavbar">
                                        <div class="me-auto">
                                        </div>
                                        <div class="d-flex">
                                                <a id="elementSeyruseferId" class="nav-link"></a>
                                        </div>
                                </div>
                        </div>
                </nav>
                <div id="elementSeyruseferDiv">
                        <p>
                                <div class="list-group">
                                        <a id="elementSettingsLink" href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                                                <div class="d-flex w-100 justify-content-between">
                                                        <h5 class="mb-1">Settings</h5>
                                                </div>
                                                <p class="mb-1">Get and/or set settings.</p>
                                        </a>
                                </div>
                                <div class="list-group">
                                        <a id="elementFirmwareLink" href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                                                <div class="d-flex w-100 justify-content-between">
                                                        <h5 class="mb-1">Firmware</h5>
                                                </div>
                                                <p class="mb-1">Get firmware information and/or update.</p>
                                        </a>
                                </div>
                                <div class="list-group">
                                        <a id="elementRestoreLink" href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                                                <div class="d-flex w-100 justify-content-between">
                                                        <h5 class="mb-1">Restore</h5>
                                                </div>
                                                <p class="mb-1">Restore to defaults.</p>
                                        </a>
                                </div>
                                <div class="list-group">
                                        <a id="elementRestartLink" href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                                                <div class="d-flex w-100 justify-content-between">
                                                        <h5 class="mb-1">Restart</h5>
                                                </div>
                                                <p class="mb-1">Restart the device.</p>
                                        </a>
                                </div>
                                <div class="list-group">
                                        <a id="elementAboutLink" href="#" class="list-group-item list-group-item-action flex-column align-items-start">
                                                <div class="d-flex w-100 justify-content-between">
                                                        <h5 class="mb-1">About</h5>
                                                </div>
                                                <p class="mb-1">Get device information.</p>
                                        </a>
                                </div>
                        </p>
                </div>
                <div id="elementSettingsDiv">
                        <p>
                                <div id="elementSettingsResultDiv">

                                </div>
                        </p>
                </div>
                <div id="elementFirmwareDiv">
                        <p>
                                <div id="elementFirmwareResultDiv">

                                </div>
                        </p>
                </div>
                <div id="elementRestoreDiv">
                        <p>
                                <div id="elementRestoreResultDiv">

                                </div>
                        </p>
                </div>
                <div id="elementRestartDiv">
                        <p>
                                <div id="elementRestartResultDiv">

                                </div>
                        </p>
                </div>
                <div id="elementAboutDiv">
                        <p>
                                <div id="elementAboutResultDiv">

                                </div>
                        </p>
                </div>
        </div>
</body>
</html>
